<%
  if @article.new_record?
    resource_path = "#{blog_root}/admin/articles"
    form_method = :post
    offer_delete = false
  else
    resource_path = "#{blog_root}/admin/articles/#{@article.id}"
    form_method = :put
    offer_delete = true
  end
%>

<% head do %>
<style type="text/css" media="screen">
  form fieldset textarea { width: 500px; }
</style>
<% end %>

<% form(resource_path, :method => form_method) do %>
  <fieldset>
    <label for="article_title">Title</label>
    <input type="text" id="article_title" name="article[title]" value="<%=h @article.title -%>">

    <label for="article_slug">Slug</label>
    <input type="text" id="article_slug" name="article[slug]" value="<%=h @article.slug -%>">

    <label for="article_byline">Byline</label>
    <input type="text" id="article_byline" name="article[byline]" value="<%= h @article.byline || me.name %>">

    <label for="article_url">Publish Date/Time</label>
    <%= UI::DateTimeTextBox.new(self, @article, "article", "published_at") %>

    <label for="article_content">Content</label>
    <textarea id="article_content" name="article[content]" rows="30"><%=h @article.content -%></textarea>
  </fieldset>
  
  <fieldset>
    <legend>Categories</legend>

    <%= render 'blog_admin/categories/_checkbox_list', :categories => Category.roots, :selected_categories => @article.categories.entries %>
  </fieldset>
  
  <input type="submit" value="Save">
<% end %>

<% if offer_delete %>
  <% form(resource_path, :method => :delete) do %>
    <input type="submit" value="Delete">
  <% end %>
<% end %>

